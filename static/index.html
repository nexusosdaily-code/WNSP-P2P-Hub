<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WNSP P2P Hub - Encrypted Social Media Networks</title>
    <link rel="stylesheet" href="css/media_player.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">üåê</div>
                    <div class="logo-text">
                        <h1>WNSP P2P Hub</h1>
                        <p class="logo-subtitle">Encrypted Social Media Networks</p>
                    </div>
                </div>
                <div class="network-status">
                    <span class="status-indicator online"></span>
                    <span class="status-text">Mesh Network Active</span>
                    <span class="node-count">10 nodes</span>
                </div>
                <div class="wallet-info" id="walletInfo" style="display: none;">
                    <div class="wallet-balance">
                        <span class="balance-label">Balance:</span>
                        <span class="balance-amount" id="walletBalance">0</span>
                        <span class="balance-unit">units</span>
                    </div>
                    <button class="wallet-btn" id="walletDetailsBtn">üíé Wallet</button>
                </div>
                <button class="wallet-login-btn" id="walletLoginBtn">üîê Connect Wallet</button>
            </div>
        </div>
    </header>

    <!-- Wallet Login/Signup Modal -->
    <div class="upload-modal" id="walletModal" style="display: none;">
        <div class="upload-modal-content">
            <div class="upload-modal-header">
                <h2>üíé NexusOS Wallet</h2>
                <button class="close-btn" id="closeWalletModal">‚úï</button>
            </div>
            <div class="upload-modal-body">
                <div class="wallet-tabs">
                    <button class="wallet-tab-btn active" data-tab="import">Import Wallet</button>
                    <button class="wallet-tab-btn" data-tab="login">Quick Login</button>
                    <button class="wallet-tab-btn" data-tab="signup">Create New</button>
                </div>
                
                <!-- Import Existing Wallet Tab -->
                <div class="wallet-tab-content" id="importTab">
                    <h3>üîó Import Blockchain Wallet</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 16px;">Connect your existing NexusOS blockchain wallet</p>
                    
                    <!-- My Wallets List -->
                    <div id="walletsList" style="margin-bottom: 20px; max-height: 200px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px; padding: 12px; background: var(--bg-primary);">
                        <h4 style="margin: 0 0 12px 0; font-size: 14px; color: var(--text-primary);">üíº My Wallets (Click to Copy)</h4>
                        <div id="walletsListContent" style="font-size: 12px;">
                            Loading...
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="importAddress">Wallet Address:</label>
                        <input type="text" id="importAddress" placeholder="NXS... (or click a wallet above)" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="importPassword">Password:</label>
                        <input type="password" id="importPassword" placeholder="Enter your wallet password" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="importDeviceName">This Device Name:</label>
                        <input type="text" id="importDeviceName" placeholder="e.g., My PC" class="form-input">
                    </div>
                    <button class="upload-btn" id="importWalletBtn" style="width: 100%;">
                        <span class="upload-icon">üîó</span>
                        Import & Connect
                    </button>
                    <p style="color: var(--success); font-size: 12px; margin-top: 12px;">
                        ‚úÖ Your balance will be shared across all devices
                    </p>
                </div>
                
                <!-- Login Tab -->
                <div class="wallet-tab-content" id="loginTab" style="display: none;">
                    <h3>Quick Device Login</h3>
                    <div class="form-group">
                        <label for="loginDeviceId">Device ID or Contact:</label>
                        <input type="text" id="loginDeviceId" placeholder="e.g., +1-234-567-8900" class="form-input">
                    </div>
                    <button class="upload-btn" id="loginWalletBtn" style="width: 100%;">
                        <span class="upload-icon">üîì</span>
                        Connect Wallet
                    </button>
                </div>
                
                <!-- Signup Tab -->
                <div class="wallet-tab-content" id="signupTab" style="display: none;">
                    <h3>Create New Wallet</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 16px;">Get 1.0 NXT (100M units) to start!</p>
                    <div class="form-group">
                        <label for="signupDeviceName">Device Name:</label>
                        <input type="text" id="signupDeviceName" placeholder="e.g., My Phone" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="signupContact">Mobile Number or Email:</label>
                        <input type="text" id="signupContact" placeholder="e.g., +1-234-567-8900" class="form-input">
                    </div>
                    <button class="upload-btn" id="createWalletBtn" style="width: 100%;">
                        <span class="upload-icon">‚ú®</span>
                        Create Wallet
                    </button>
                </div>
                
                <div class="wallet-info-box">
                    <h4>üì± Your Phone IS the Blockchain</h4>
                    <p>Access full blockchain features:</p>
                    <ul>
                        <li>üí± DEX Trading</li>
                        <li>üèõÔ∏è Validator Staking</li>
                        <li>üìä Blockchain Explorer</li>
                        <li>üåê DAG Messaging</li>
                    </ul>
                    <a href="/mobile_blockchain_hub" class="blockchain-hub-link" target="_blank">
                        Open Mobile Blockchain Hub ‚Üí
                    </a>
                </div>
                
                <div class="upload-status" id="walletStatus"></div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Category Navigation -->
            <nav class="category-nav">
                <button class="category-btn active" data-category="all">
                    <span class="icon">üìö</span>
                    All Content
                </button>
                <button class="category-btn" data-category="university">
                    <span class="icon">üéì</span>
                    University
                </button>
                <button class="category-btn" data-category="refugee">
                    <span class="icon">üèïÔ∏è</span>
                    Refugee Resources
                </button>
                <button class="category-btn" data-category="rural">
                    <span class="icon">üåæ</span>
                    Rural Communities
                </button>
                <button class="category-btn" data-category="crisis">
                    <span class="icon">üö®</span>
                    Crisis Response
                </button>
            </nav>

            <!-- Search Bar -->
            <div class="search-container">
                <input type="text" class="search-input" placeholder="Search for videos, audio, documents..." id="searchInput">
                <span class="search-icon">üîç</span>
            </div>

            <!-- Upload Section -->
            <div class="upload-section">
                <button class="upload-btn" id="uploadBtn">
                    <span class="upload-icon">üì§</span>
                    Upload Media to WNSP Network
                </button>
                <button class="upload-btn" id="manageFriendsBtn" style="margin-left: 12px;">
                    <span class="upload-icon">üë•</span>
                    Manage Friends
                </button>
                <a href="livestream.html" class="upload-btn" style="margin-left: 12px; text-decoration: none; display: inline-flex; align-items: center; gap: 8px;">
                    <span class="upload-icon">üìπ</span>
                    Go Live - Peer-to-Peer Broadcasting
                </a>
            </div>

            <!-- Upload Modal -->
            <div class="upload-modal" id="uploadModal" style="display: none;">
                <div class="upload-modal-content">
                    <div class="upload-modal-header">
                        <h2>Upload to WNSP Mesh Network</h2>
                        <button class="close-btn" id="closeUploadModal">‚úï</button>
                    </div>
                    <div class="upload-modal-body">
                        <div class="upload-drop-zone" id="uploadDropZone">
                            <div class="upload-icon-large">üìÅ</div>
                            <p class="upload-text">Drag & drop media files here</p>
                            <p class="upload-subtext">or click to browse</p>
                            <p class="upload-formats">MP3, MP4, PDF (max 100MB)</p>
                            <input type="file" id="fileInput" accept="audio/mpeg,audio/mp3,video/mp4,video/*,application/pdf,.mp3,.mp4,.pdf" multiple style="display: none;">
                        </div>
                        <div class="upload-category-select">
                            <label for="uploadCategory">Target Community:</label>
                            <select id="uploadCategory" class="category-dropdown">
                                <option value="university">üéì University</option>
                                <option value="refugee">üèïÔ∏è Refugee Resources</option>
                                <option value="rural">üåæ Rural Communities</option>
                                <option value="crisis">üö® Crisis Response</option>
                            </select>
                        </div>
                        <div class="upload-encryption-option">
                            <label>
                                <input type="checkbox" id="enableEncryption" checked>
                                <span>üîê Enable Quantum Encryption (E=hf secured)</span>
                            </label>
                        </div>
                        <!-- Share Mode Selection -->
                        <div class="upload-share-mode">
                            <label class="share-mode-label">üì° Share With:</label>
                            <div class="share-mode-options">
                                <label class="radio-option">
                                    <input type="radio" name="shareMode" value="broadcast" checked>
                                    <span>Entire Network (All Nodes)</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="shareMode" value="friends">
                                    <span>Selected Friends Only</span>
                                </label>
                            </div>
                        </div>
                        <!-- Friend Selection (Hidden by default, shown when Friends mode selected) -->
                        <div class="upload-friend-selection" id="friendSelection" style="display: none;">
                            <label class="friend-list-label">üë• Select Friends:</label>
                            <div class="friend-list-container" id="friendListContainer">
                                <div class="loading-peers">üîç Discovering nearby peers...</div>
                            </div>
                        </div>
                        <div class="upload-progress" id="uploadProgress" style="display: none;">
                            <div class="progress-bar-upload">
                                <div class="progress-fill-upload" id="uploadProgressFill"></div>
                            </div>
                            <p class="progress-text" id="uploadProgressText">Uploading...</p>
                        </div>
                        <div class="upload-status" id="uploadStatus"></div>
                    </div>
                </div>
            </div>

            <!-- Friend Management Modal -->
            <div class="upload-modal" id="friendsModal" style="display: none;">
                <div class="upload-modal-content">
                    <div class="upload-modal-header">
                        <h2>üë• Manage Friends</h2>
                        <button class="close-btn" id="closeFriendsModal">‚úï</button>
                    </div>
                    <div class="upload-modal-body">
                        <!-- Add Friend Form -->
                        <div class="add-friend-form">
                            <h3>Add New Friend</h3>
                            <div class="form-group">
                                <label for="friendName">Friend's Name:</label>
                                <input type="text" id="friendName" placeholder="e.g., Alice Smith" class="form-input">
                            </div>
                            <div class="form-group">
                                <label for="friendContact">Mobile Number or Device ID:</label>
                                <input type="text" id="friendContact" placeholder="e.g., +1-234-567-8900 or device_abc123" class="form-input">
                            </div>
                            <button class="upload-btn" id="addFriendBtn" style="width: 100%;">
                                <span class="upload-icon">‚ûï</span>
                                Add Friend
                            </button>
                        </div>
                        
                        <!-- Friends List -->
                        <div class="friends-list-section">
                            <h3>Your Friends (<span id="friendCount">0</span>)</h3>
                            <div class="friends-list" id="friendsList">
                                <div class="loading-peers">No friends added yet</div>
                            </div>
                        </div>
                        
                        <div class="upload-status" id="friendsStatus"></div>
                    </div>
                </div>
            </div>

            <!-- Media Grid -->
            <div class="media-section">
                <h2 class="section-title">Available Content</h2>
                <div class="media-grid" id="mediaGrid">
                    <!-- Media cards will be dynamically inserted here -->
                </div>
            </div>

            <!-- Currently Playing Section -->
            <div class="now-playing-section" id="nowPlayingSection" style="display: none;">
                <h2 class="section-title">Now Playing</h2>
                <div class="player-container">
                    <!-- Video Player -->
                    <div class="video-player-wrapper" id="videoPlayerWrapper" style="display: none;">
                        <video id="videoPlayer" class="video-player" controls></video>
                        <div class="video-info">
                            <h3 class="video-title" id="videoTitle"></h3>
                            <p class="video-meta" id="videoMeta"></p>
                        </div>
                    </div>

                    <!-- Audio Player -->
                    <div class="audio-player-wrapper" id="audioPlayerWrapper" style="display: none;">
                        <div class="audio-player">
                            <audio id="audioPlayer" class="audio-element"></audio>
                            <div class="audio-cover">
                                <div class="cover-art" id="coverArt">üéµ</div>
                            </div>
                            <div class="audio-info">
                                <h3 class="audio-title" id="audioTitle"></h3>
                                <p class="audio-artist" id="audioArtist"></p>
                            </div>
                            <div class="audio-controls">
                                <button class="control-btn" id="prevBtn">‚èÆ</button>
                                <button class="control-btn play-pause" id="playPauseBtn">‚ñ∂Ô∏è</button>
                                <button class="control-btn" id="nextBtn">‚è≠</button>
                                <button class="control-btn" id="shuffleBtn">üîÄ</button>
                                <button class="control-btn" id="repeatBtn">üîÅ</button>
                            </div>
                            <div class="progress-container">
                                <div class="time-display">
                                    <span id="currentTime">0:00</span>
                                    <span id="duration">0:00</span>
                                </div>
                                <div class="progress-bar" id="progressBar">
                                    <div class="progress-fill" id="progressFill"></div>
                                </div>
                            </div>
                            <div class="volume-container">
                                <span class="volume-icon">üîä</span>
                                <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="70">
                            </div>
                        </div>
                    </div>

                    <!-- Document Viewer -->
                    <div class="document-viewer-wrapper" id="documentViewerWrapper" style="display: none;">
                        <iframe id="documentViewer" class="document-viewer"></iframe>
                        <div class="document-info">
                            <h3 class="document-title" id="documentTitle"></h3>
                            <p class="document-meta" id="documentMeta"></p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Network Stats -->
            <div class="network-stats">
                <div class="stat-card">
                    <div class="stat-icon">üì¶</div>
                    <div class="stat-info">
                        <span class="stat-value" id="cacheSize">0 MB</span>
                        <span class="stat-label">Cached Locally</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚ö°</div>
                    <div class="stat-info">
                        <span class="stat-value" id="energySpent">0.000</span>
                        <span class="stat-label">Energy (NXT)</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üì°</div>
                    <div class="stat-info">
                        <span class="stat-value" id="propagations">0</span>
                        <span class="stat-label">Propagations</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üéØ</div>
                    <div class="stat-info">
                        <span class="stat-value" id="cacheHitRate">0%</span>
                        <span class="stat-label">Cache Hit Rate</span>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>WNSP Media Hub - Decentralized Knowledge Network | GPL v3.0 License</p>
            <p class="footer-tagline">Empowering communities through physics-based mesh networking</p>
        </div>
    </footer>

    <script src="js/media_player_enhanced.js?v=mobile-fix-20251124"></script>
</body>
</html>
